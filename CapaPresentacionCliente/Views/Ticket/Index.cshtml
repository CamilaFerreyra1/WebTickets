@{
    ViewBag.Title = "Listado de Tickets";
}

<h1 class="mt-4 border p-3 bg-dark text-white">Listado de Tickets</h1>
<ol class="breadcrumb mb-4">
    @*<li class="breadcrumb-item active">Tickets</li>*@
</ol>

<div class="row">
    <div class="col-md-12">
        <div class="card mb-4">
            <div class="card-header bg-dark text-white">
                <i class="fas fa-ticket-alt me-1"></i>
                Tickets
            </div>
            <div class="card-body">
                <table id="tablaTickets" class="display cell-border" style="width:100%; border: 1px solid #dee2e6;">
                    <thead class="thead-light" style="background-color: #871752; color: #ffffff;">
                        <tr>
                            <th style="border: 1px solid #dee2e6;">Id Ticket</th>
                            <th style="border: 1px solid #dee2e6;">Id Cliente</th>
                            <th style="border: 1px solid #dee2e6;">Asunto</th>
                            <th style="border: 1px solid #dee2e6;">Descripción</th>
                            <th style="border: 1px solid #dee2e6;">Estado</th>
                            <th style="border: 1px solid #dee2e6;">Fecha de Creación</th>
                            <th style="border: 1px solid #dee2e6;">Fecha de Cierre</th>
                            <th style="border: 1px solid #dee2e6;">Prioridad</th>
                            <th style="border: 1px solid #dee2e6;">Comentario</th>
                        </tr>
                    </thead>
                    <tbody style="background-color: #e8eaf6; color: #6a1b9a;">
                        <!-- Table data will be populated here via DataTables -->
                    </tbody>
                </table>

                <div class="row mt-2">
                    <div class="col-12">
                        <div id="mensajeError" class="alert alert-danger" role="alert" style="display:none;">
                            A simple danger alert—check it out!
                        </div>
                    </div>
                </div>
                <div class="d-grid mt-3">
                    <a href="@Url.Action("RegistrarTicket", "Ticket")" class="btn btn-primary"><i class="fas fa-plus"></i> Nuevo Ticket</a>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.21/css/jquery.dataTables.min.css">

    <script type="text/javascript">
        $(document).ready(function () {
            var url = '@Url.Action("ListarTickets", "Ticket")';
            var tabladata = $("#tablaTickets").DataTable({
                responsive: true,
                ordering: false,
                "ajax": {
                    url: url,
                    type: "GET",
                    dataType: "json",
                    error: function (jqXHR, textStatus, errorThrown) {
                        console.log('Error: ' + textStatus + ' - ' + errorThrown);
                    }
                },
                "columns": [
                    { "data": "IdTicket" },
                    { "data": "IdCliente" },
                    { "data": "Asunto" },
                    { "data": "Descripcion" },
                    { "data": "Estado" },
                    { "data": "FechaCreacion" },
                    { "data": "FechaCierre" },
                    { "data": "Prioridad" },
                    { "data": "Comentario" }
                ],
                "language": {
                    "url": "https://cdn.datatables.net/plug-ins/1.11.3/i18n/es_es.json"
                }
            });
        });
    </script>
}
